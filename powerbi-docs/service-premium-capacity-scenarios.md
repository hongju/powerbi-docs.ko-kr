---
title: Microsoft Power BI 프리미엄 용량 시나리오
description: 일반적인 Power BI 프리미엄 용량 시나리오에 대해 설명합니다.
author: mgblythe
ms.author: mblythe
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-admin
ms.topic: conceptual
ms.date: 04/09/2019
ms.custom: seodec18
LocalizationGroup: Premium
ms.openlocfilehash: 3190645044c930c1c63fd7c199883d784723d6f0
ms.sourcegitcommit: 64c860fcbf2969bf089cec358331a1fc1e0d39a8
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/09/2019
ms.locfileid: "73881252"
---
# <a name="premium-capacity-scenarios"></a>프리미엄 용량 시나리오

이 문서에서는 Power BI 프리미엄 용량이 구현된 실제 시나리오에 대해 설명합니다. 일반적인 문제와 과제를 설명하고, 문제를 식별하고 해결하는 방법에 대해서도 설명합니다.

- [데이터 세트를 최신 상태로 유지](#keeping-datasets-up-to-date)
- [느리게 응답하는 데이터 세트 식별](#identifying-slow-responding-datasets)
- [산발적으로 느리게 응답하는 데이터 세트에 대한 원인 파악](#identifying-causes-for-sporadically-slow-responding-datasets)
- [충분한 메모리가 있는지 확인](#determining-whether-there-is-enough-memory)
- [충분한 CPU가 있는지 확인](#determining-whether-there-is-enough-cpu)

이러한 단계는 차트 및 테이블 예와 함께 Power BI 관리자가 액세스할 수 있는 **Power BI 프리미엄 용량 메트릭 앱**에서 가져온 것입니다.

## <a name="keeping-datasets-up-to-date"></a>데이터 세트를 최신 상태로 유지

이 시나리오에서는 사용자가 보고서 데이터가 때때로 오래되었거나 "부실한" 것으로 보인다고 불평했을 때 조사가 트리거되었습니다.

앱에서 관리자는 시각적 개체 **새로 고침**과 상호 작용하여 **최대 대기 시간** 통계에 따라 데이터 세트를 내림차순으로 정렬합니다. 이 시각적 개체는 작업 영역 이름별로 그룹화된 대기 시간이 가장 긴 데이터 세트를 표시하는 데 도움이 됩니다.

![최대 대기 시간을 기준으로 내림차순으로 정렬하고 작업 영역별로 그룹화하는 데이터 세트 새로 고침](media/service-premium-capacity-scenarios/dataset-refreshes.png)

**시간별 평균 새로 고침 대기 시간** 시각적 개체에서 새로 고침 대기 시간이 일관되게 매일 오후 4시쯤에 최고 수준임을 알 수 있습니다.

![주기적으로 오후 4시의 최고치를 대기하는 새로 고침](media/service-premium-capacity-scenarios/peak-refresh-waits.png)

이러한 결과에 대해 가능한 몇 가지 설명은 다음과 같습니다.

- 용량 노드에서 정의한 제한을 초과하여 너무 많은 새로 고침 시도가 동시에 발생할 수 있습니다. 이 경우 기본 메모리 할당을 사용하여 P1에서 6개의 새로 고침을 동시에 수행합니다.

- 새로 고칠 데이터 세트가 너무 커서 사용 가능한 메모리에 맞지 않을 수 있습니다(전체 새로 고침에 필요한 메모리의 2배 이상 필요).
- 비효율적인 파워 쿼리 논리로 인해 데이터 세트를 새로 고치는 동안 메모리 사용량이 급증할 수 있습니다. 사용량이 많은 용량에서 이 급증은 실제 한도에 도달하여 새로 고침이 실패하고, 용량에 대한 다른 보고서 보기 작업에 영향을 줄 수 있습니다.
- 메모리에서 유지해야 하는 자주 쿼리되는 데이터 세트는 사용 가능한 메모리가 제한되어 있으므로 다른 데이터 세트의 새로 고침 기능에 영향을 줄 수 있습니다.

조사를 돕기 위해 Power BI 관리자는 다음 사항을 확인할 수 있습니다.

- 사용 가능한 메모리가 새로 고칠 데이터 세트의 2배 미만이면 데이터를 새로 고칠 때 사용 가능한 메모리가 부족합니다.
- 데이터 세트가 새로 고쳐지지 않고 새로 고치기 전에 메모리에 없지만, 새로 고침 시간이 많이 걸리는 동안 대화형 트래픽이 표시되기 시작했습니다. 지정된 시간에 메모리에 로드되는 데이터 세트를 확인하기 위해 Power BI 관리자는 앱에서 **데이터 세트** 탭의 데이터 세트 영역을 볼 수 있습니다. 그런 다음, 관리자는 **시간별 로드된 데이터 세트 수**에서 막대 중 하나를 클릭하여 지정된 시간까지 교차 필터링할 수 있습니다. 아래 이미지에 표시된 로컬 급증은 여러 데이터 세트가 메모리에 로드된 1시간을 나타내며, 이로 인해 예약된 새로 고침이 지연될 수 있습니다.
- 데이터 새로 고침이 시작되도록 예약하면 데이터 세트 제거가 증가합니다. 제거는 새로 고침을 수행하기 전에 너무 많은 다양한 대화형 보고서를 제공하여 메모리 부족이 발생했음을 나타낼 수 있습니다. **시간별 데이터 세트 제거 및 메모리 사용량** 시각적 개체는 제거의 급증을 명확하게 나타낼 수 있습니다.

다음 이미지에서는 로드된 데이터 세트의 로컬 급증을 보여 줍니다. 이는 지연된 새로 고침 시작을 대화형으로 쿼리하도록 제안합니다. **시간별 로드된 데이터 세트 수** 시각적 개체에서 기간을 선택하면 **데이터 세트 크기** 시각적 개체를 교차 필터링합니다.

![지연된 새로 고침 시작을 대화형으로 쿼리하도록 제안하는 로드된 데이터 세트의 로컬 급증](media/service-premium-capacity-scenarios/hourly-loaded-dataset-counts.png)

Power BI 관리자는 다음과 같이 데이터 새로 고침을 시작하는 데 사용할 수 있는 충분한 메모리를 확보하기 위한 단계를 수행하여 문제를 해결하려고 시도할 수 있습니다.

- 데이터 세트 소유자에게 연락하여 데이터 새로 고침 일정을 엇갈리게 하여 공간을 확보할 수 있도록 요청합니다.
- 불필요한 대시보드 또는 대시보드 타일, 특히 행 수준 보안을 적용하는 대시보드 또는 대시보드 타일을 제거하여 데이터 세트 쿼리 로드를 줄입니다.
- 파워 쿼리 논리를 최적화하여 데이터 새로 고침 속도를 높입니다. 모델링 계산 열 또는 테이블을 향상시킵니다. 데이터 세트 크기를 줄이거나 증분 데이터 새로 고침을 수행하는 더 큰 데이터 세트를 구성합니다.

## <a name="identifying-slow-responding-datasets"></a>느리게 응답하는 데이터 세트 식별

이 시나리오에서는 사용자가 특정 보고서를 여는 데 시간이 너무 오래 걸리고 때로는 중단되는 경우가 있다고 불평했을 때 조사가 시작되었습니다.

앱에서 Power BI 관리자는 **쿼리 기간** 시각적 개체를 사용하여 **평균 기간**을 기준으로 내림차순으로 정렬함으로써 최악의 성능을 수행하는 데이터 세트를 확인할 수 있습니다. 또한 이 시각적 개체는 데이터 세트 쿼리 수도 보여 주므로 데이터 세트를 쿼리하는 빈도를 확인할 수 있습니다.

![최악의 성능을 수행하는 데이터 세트](media/service-premium-capacity-scenarios/worst-performing-datasets.png)

관리자는 필터링된 기간 동안 버킷 구성된 쿼리 성능(30밀리초 이하, 0-100밀리초)의 전체 분포를 보여 주는 **쿼리 기간 분포** 시각적 개체를 참조할 수 있습니다. 일반적으로 1초 이하의 쿼리는 대부분의 사용자가 응답하는 것으로 간주됩니다. 더 오래 걸리는 쿼리는 성능이 저하된다는 인식을 만드는 경향이 있습니다.

**시간별 쿼리 기간 분포** 시각적 개체를 사용하면 Power BI 관리자가 용량 성능이 저하된 것으로 인식될 수 있는 1시간의 기간을 식별할 수 있습니다. 1초가 넘는 쿼리 기간을 나타내는 막대 세그먼트가 클수록 사용자가 성능 저하를 인식할 위험이 더 커집니다.

시각적 개체는 대화형이며, 막대 세그먼트를 선택하면 보고서 페이지의 해당 **쿼리 기간** 테이블 시각적 개체가 교차 필터링되어 해당 데이터 세트를 표시합니다. 이 교차 필터링을 통해 Power BI 관리자는 느리게 응답하는 데이터 세트를 쉽게 식별할 수 있습니다.

다음 이미지에서는 **시간별 쿼리 기간 분포**를 기준으로 필터링된 시각적 개체를 보여 주며, 1시간 버킷에서 최악의 성능을 수행하는 데이터 세트에 초점을 맞추고 있습니다. 

![성능이 저하된 데이터 세트를 보여 주는 필터링된 쿼리 기간 분포 시각적 개체](media/service-premium-capacity-scenarios/hourly-query-duration-distributions.png)

특정 1시간의 시간 범위에서 성능이 저하된 데이터 세트가 식별되면 Power BI 관리자는 오버로드된 용량으로 인해 성능이 저하되었는지, 아니면 데이터 세트 또는 보고서의 잘못된 설계로 인해 성능이 저하되었는지를 조사할 수 있습니다. **쿼리 대기 시간** 시각적 개체를 참조하고, 평균 쿼리 대기 시간을 기준으로 내림차순으로 데이터 세트를 정렬할 수 있습니다. 많은 비율의 쿼리가 대기 중인 경우 데이터 세트에 대한 수요가 높으면 쿼리 대기가 너무 많아질 수 있습니다. 평균 쿼리 대기 시간이 상당한 경우(100밀리초 초과) 데이터 세트를 검토하여 최적화를 수행할 수 있는지를 보고하는 것이 좋을 수 있습니다. 예를 들어 지정된 보고서 페이지 또는 DAX 식 최적화에 대한 시각적 개체의 수를 줄일 수 있습니다.

![성능이 저하된 데이터 세트를 표시하는 데 도움이 되는 쿼리 대기 시간 시각적 개체](media/service-premium-capacity-scenarios/query-wait-times.png)

데이터 세트에서 쿼리 대기 시간이 축적되어야 하는 몇 가지 이유는 다음과 같습니다.

- 최적이 아닌 모델 설계, 측정값 식 또는 보고서 설계 - 높은 수준의 CPU를 사용하는 장기 실행 쿼리에 기여할 수 있는 모든 상황입니다. 이 경우 CPU 스레드를 사용할 수 있을 때까지 새 쿼리를 강제로 대기하도록 하고, 일반적으로 최고 업무 시간 동안에 표시되는 호위 상태(정체 현상)가 발생할 수 있습니다. **쿼리 대기 수** 페이지는 데이터 세트의 평균 쿼리 대기 시간이 높은지 여부를 결정하는 기본 리소스입니다.
- 동일한 보고서 또는 데이터 세트를 사용하는 많은 수의 동시 용량 사용자(수백 ~ 수천 명). 잘 설계된 데이터 세트조차도 동시성 임계값을 초과하여 성능이 저하될 수 있습니다. 이 경우 일반적으로 다른 데이터 세트에서 표시하는 것보다 현저히 더 높은 값의 쿼리 수를 보여 주는 단일 데이터 세트로 표시됩니다(예: 다른 모든 데이터 세트의 30,000개 미만의 쿼리와 비교하여 한 데이터 세트의 쿼리는 300,000개임). 특정 시점에서 이 데이터 세트에 대한 쿼리 대기 수가 어긋나기 시작하며, 이는 **쿼리 기간** 시각적 개체에서 확인할 수 있습니다.
- 여러 개의 서로 다른 데이터 세트가 동시에 쿼리 - 데이터 세트가 메모리 내/외부로 자주 순환하므로 쓰레싱이 발생합니다. 이로 인해 데이터 세트가 메모리에 로드될 때 성능이 저하됩니다. 확인을 위해 Power BI 관리자는 **시간별 데이터 세트 제거 및 메모리 사용량** 시각적 개체를 참조할 수 있습니다. 이 시각적 개체는 메모리에 로드된 많은 수의 데이터 세트가 반복적으로 제거되고 있음을 나타낼 수 있습니다.

## <a name="identifying-causes-for-sporadically-slow-responding-datasets"></a>산발적으로 느리게 응답하는 데이터 세트에 대한 원인 파악

이 시나리오에서는 사용자가 보고서 시각적 개체의 응답 속도가 때로는 느리거나 응답하지 않을 수 있다고 설명했을 때 조사가 시작되었지만, 다른 경우에는 응답 속도가 적절했습니다.

앱 내에서 다음과 같은 방법으로 **쿼리 기간** 섹션을 사용하여 원인이 되는 데이터 세트를 찾았습니다.

- **쿼리 기간** 시각적 개체에서 관리자는 데이터 세트를 기준으로 데이터 세트를 필터링하고(가장 먼저 쿼리된 데이터 세트에서 시작), **시간별 쿼리 분포** 시각적 개체에서 교차 필터링된 막대를 검사했습니다.
- 단일 1시간 막대에서 모든 쿼리 기간 그룹과 해당 데이터 세트의 다른 1시간 막대 간의 비율에서 크게 변경된 경우(예: 색 간의 비율이 크게 변경됨) 이 데이터 세트의 성능이 산발적으로 변경되었음을 의미합니다.
- 성능이 저하된 쿼리의 불규칙한 부분을 보여 주는 1시간 막대는 다른 데이터 세트의 활동으로 인한 노이즈가 많은 환경 효과의 영향을 받은 데이터 세트의 시간 범위를 나타냅니다.

아래 이미지에서는 1월 30일의 1시간을 보여 주며, "(3s,10s]" 실행 기간 버킷의 크기로 표시되어 데이터 세트의 성능이 크게 저하되었습니다. 이 1시간 막대를 클릭하면 해당 시간 동안 메모리에 로드된 모든 데이터 세트가 표시되고, 노이즈가 많은 환경 효과가 발생할 수 있는 데이터 세트가 표시됩니다.

![큰 부분으로 최악의 성능을 표시하는 막대](media/service-premium-capacity-scenarios/worst-performing-queries.png)

문제가 있는 시간 범위가 식별되면(예: 위 이미지의 1월 30일 동안) Power BI 관리자는 모든 데이터 세트 필터를 제거한 다음, 해당 시간 범위만 기준으로 필터링하여 이 시간 동안 활발하게 쿼리된 데이터 세트를 확인할 수 있습니다. 노이즈가 많은 환경 효과의 원인이 되는 데이터 세트는 일반적으로 가장 많이 쿼리되는 데이터 세트 또는 평균 쿼리 기간이 가장 긴 데이터 세트입니다.

이 문제를 해결하려면 원인이 되는 데이터 세트를 다른 프리미엄 용량의 다른 작업 영역에 배포하거나 데이터 세트 크기, 소비 요구 사항 및 데이터 새로 고침 패턴이 지원되는 경우 공유 용량에 배포합니다.

반대의 경우도 마찬가지입니다. Power BI 관리자는 데이터 세트 쿼리의 성능이 크게 향상되는 시간을 확인한 다음, 없어진 항목을 찾을 수 있습니다. 해당 시점에서 특정 정보가 누락되면 문제의 원인을 파악하는 데 도움이 될 수 있습니다.

## <a name="determining-whether-there-is-enough-memory"></a>충분한 메모리가 있는지 확인

용량에 워크로드를 완료하는 데 충분한 메모리가 있는지 확인하기 위해 Power BI 관리자는 앱의 **데이터 세트** 탭에서 **사용된 메모리 비율** 시각적 개체를 참조할 수 있습니다. **모든**(총) 메모리는 활발하게 쿼리되거나 처리되는지 여부에 관계없이 메모리에 로드된 데이터 세트에서 사용하는 메모리를 나타냅니다. **활성** 메모리는 현재 활발하게 처리 중인 데이터 세트에서 사용하는 메모리를 나타냅니다.

정상 용량의 경우 시각적 개체는 다음과 같으며, 전체(총) 메모리와 활성 메모리 사이의 간격을 보여 줍니다.

![모든(총) 메모리와 활성 메모리 사이의 간격을 보여 주는 정상 용량](media/service-premium-capacity-scenarios/memory-healthy-capacity.png)

메모리 압력이 발생하는 용량에서 동일한 시각적 개체는 추가 데이터 세트를 메모리에 로드할 수 없음을 나타내는 활성 메모리와 총 메모리의 수렴을 명확히 표시합니다. 이 경우 Power BI 관리자는 관리 포털에 있는 용량 설정 영역의 **고급 옵션**에서 **용량 다시 시작**을 클릭할 수 있습니다. 용량을 다시 시작하면 모든 데이터 세트가 메모리에서 플러시되고, 필요한 경우 쿼리 또는 데이터 새로 고침을 통해 메모리로 다시 로드될 수 있습니다.

![**모든** 메모리와 수렴되는 **활성** 메모리](media/service-premium-capacity-scenarios/memory-unhealthy-capacity.png)

## <a name="determining-whether-there-is-enough-cpu"></a>충분한 CPU가 있는지 확인

일반적으로 용량의 평균 CPU 사용률은 80% 미만으로 유지되어야 합니다. 이 값을 초과하면 용량이 CPU 포화 상태에 근접하고 있음을 의미합니다.

CPU 포화 효과는 모든 작업을 처리하려고 시도할 때 많은 CPU 컨텍스트 전환을 수행하는 용량으로 인해 필요한 것보다 더 오래 걸리는 작업으로 표현됩니다. 동시 쿼리 수가 많은 프리미엄 용량에서 이는 높은 쿼리 대기 시간으로 표시됩니다. 쿼리 대기 시간이 높으면 응답성이 평소보다 저하됩니다. Power BI 관리자는 **시간별 쿼리 대기 시간 분포** 시각적 개체를 확인하여 CPU의 포화 상태를 쉽게 식별할 수 있습니다. 주기적인 최고 쿼리 대기 시간 수는 잠재적인 CPU 포화 상태를 나타냅니다.

![쿼리 대기 시간 카운트의 주기적인 피크는 잠재적인 CPU 포화 상태를 나타냅니다.](media/service-premium-capacity-scenarios/peak-query-wait-times.png)

CPU 포화에 기여하는 경우 백그라운드 작업에서도 비슷한 패턴이 검색될 수 있는 경우가 있습니다. Power BI 관리자는 특정 데이터 세트의 새로 고침 시간에서 주기적인 급증을 확인할 수 있습니다. 이는 아마도 다른 진행 중인 데이터 세트 새로 고침 및/또는 대화형 쿼리로 인해 해당 시점의 CPU 포화를 나타낼 수 있습니다. 이 경우 앱에서 **시스템** 보기를 참조하여 CPU가 100%임을 반드시 확인할 필요가 없습니다. **시스템** 보기는 시간별 평균을 표시하지만, CPU가 몇 분 동안의 과도한 작업으로 포화 상태가 될 수 있으며, 이는 대기 시간의 급증으로 표시됩니다.

CPU 포화의 영향을 이해하는 데 더 미묘한 차이가 있습니다. 대기하는 쿼리의 수는 중요하지만, 쿼리 대기 시간은 눈에 띄는 성능 저하를 발생시키지 않으면서 항상 어느 정도 발생합니다. 일부 데이터 세트(복잡성 또는 크기를 나타내는 더 긴 평균 쿼리 시간 사용)는 다른 데이터 세트보다 CPU 포화의 영향을 받기 쉽습니다. 이러한 데이터 세트를 쉽게 식별하기 위해 Power BI 관리자는 **시간별 대기 시간 분포** 시각적 개체에서 막대 색 구성에 대한 변경을 확인할 수 있습니다. 이상값 막대가 검색되면 해당 시간 동안 쿼리 대기 시간이 있었던 데이터 세트를 확인할 수 있으며 평균 쿼리 기간과 비교한 평균 쿼리 대기 시간도 확인할 수 있습니다. 이러한 두 메트릭의 크기가 동일하고 데이터 세트의 쿼리 워크로드가 어느 정도 중요한 경우 데이터 세트는 CPU 부족으로 인한 영향을 받을 수 있습니다.

이 영향은 여러 사용자가 자주 사용하는 쿼리의 짧은 버스트(예: 학습 세션)에서 데이터 세트를 사용하여 각 버스트 동안 CPU 포화를 발생시킬 때 특히 분명할 수 있습니다. 이 경우 이 데이터 세트에서 상당한 쿼리 대기 시간이 발생할 수 있을 뿐만 아니라 용량의 다른 데이터 세트에도 영향을 줄 수 있습니다(노이즈가 많은 환경 효과).

경우에 따라 Power BI 관리자는 보고서 대신 대시보드(캐시된 타일에 대한 데이터 세트 새로 고침을 사용하여 정기적으로 쿼리)를 만들어 데이터 세트 소유자에게 휘발성이 낮은 쿼리 워크로드를 만들도록 요청할 수 있습니다. 이렇게 하면 대시보드가 로드될 때 급증을 방지할 수 있습니다. 이 해결 방법은 지정된 비즈니스 요구 사항에 대해 항상 가능한 것은 아니지만 데이터 세트를 변경하지 않고도 CPU 포화를 방지하는 효과적인 방법이 될 수 있습니다.

## <a name="acknowledgements"></a>승인

이 문서는 데이터 플랫폼 MVP이자 [Bitwise Solutions](https://www.bitwisesolutions.com.au/)의 독립 BI 전문가인 Peter Myers가 작성한 것입니다.

## <a name="next-steps"></a>다음 단계

> [!div class="nextstepaction"]
> [앱을 사용하여 프리미엄 용량 모니터링](service-admin-premium-monitor-capacity.md)    
> [!div class="nextstepaction"]
> [관리 포털에서 용량 모니터링](service-admin-premium-monitor-portal.md)   

궁금한 점이 더 있나요? [Power BI 커뮤니티에 질문합니다.](https://community.powerbi.com/)

||||||